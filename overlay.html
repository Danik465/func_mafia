<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ü–ª–∞—à–∫–∏ —Å –∞–Ω–∏–º–∞—Ü–∏–µ–π –æ–ø—É—Å–∫–∞–Ω–∏—è</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
     <div class="container">
        <h1>–ü–ª–∞—à–∫–∏ —Å –∞–Ω–∏–º–∞—Ü–∏–µ–π –æ–ø—É—Å–∫–∞–Ω–∏—è</h1>
    <div class="cards-row">
        <!-- –ü–ª–∞—à–∫–∏ 1-10 -->
        <div class="card-wrapper">
            <div class="card" id="card-1">
                <div class="card-number">1</div> <!-- –î–û–ë–ê–í–õ–ï–ù–û: –ù–æ–º–µ—Ä –ø–ª–∞—à–∫–∏ -->
                <div class="card-text"></div>
                <img class="default-image" src="default.png" alt="–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ 1">
                <img class="status-icon" id="status-icon-1" alt="–°—Ç–∞—Ç—É—Å">
                <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –∫–∞—Ä—Ç–æ—á–µ–∫ –º–∞—Ñ–∏–∏ –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω –≤ JavaScript -->
            </div>
            <img class="role-icon" id="role-icon-1" alt="–†–æ–ª—å">
            <!-- –î–û–ë–ê–í–õ–ï–ù–û: –ò–∫–æ–Ω–∫–∞ —á–µ—Ä–Ω–æ–π –∫–∞—Ä—Ç—ã -->
            <img class="black-card-icon" id="black-card-icon-1" src="Roles/–ú–∞—Ñ–∏—è.svg" alt="–ß–µ—Ä–Ω–∞—è –∫–∞—Ä—Ç–∞">
        </div>
        <div class="card-wrapper">
            <div class="card" id="card-2">
                <div class="card-number">2</div> <!-- –î–û–ë–ê–í–õ–ï–ù–û: –ù–æ–º–µ—Ä –ø–ª–∞—à–∫–∏ -->
                <div class="card-text"></div>
                <img class="default-image" src="default.png" alt="–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ 2">
                <img class="status-icon" id="status-icon-2" alt="–°—Ç–∞—Ç—É—Å">
            </div>
            <img class="role-icon" id="role-icon-2" alt="–†–æ–ª—å">
            <!-- –î–û–ë–ê–í–õ–ï–ù–û: –ò–∫–æ–Ω–∫–∞ —á–µ—Ä–Ω–æ–π –∫–∞—Ä—Ç—ã -->
            <img class="black-card-icon" id="black-card-icon-2" src="Roles/–ú–∞—Ñ–∏—è.svg" alt="–ß–µ—Ä–Ω–∞—è –∫–∞—Ä—Ç–∞">
        </div>
        <div class="card-wrapper">
            <div class="card" id="card-3">
                <div class="card-number">3</div> <!-- –î–û–ë–ê–í–õ–ï–ù–û: –ù–æ–º–µ—Ä –ø–ª–∞—à–∫–∏ -->
                <div class="card-text"></div>
                <img class="default-image" src="default.png" alt="–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ 3">
                <img class="status-icon" id="status-icon-3" alt="–°—Ç–∞—Ç—É—Å">
            </div>
            <img class="role-icon" id="role-icon-3" alt="–†–æ–ª—å">
            <!-- –î–û–ë–ê–í–õ–ï–ù–û: –ò–∫–æ–Ω–∫–∞ —á–µ—Ä–Ω–æ–π –∫–∞—Ä—Ç—ã -->
            <img class="black-card-icon" id="black-card-icon-3" src="Roles/–ú–∞—Ñ–∏—è.svg" alt="–ß–µ—Ä–Ω–∞—è –∫–∞—Ä—Ç–∞">
        </div>
        <div class="card-wrapper">
            <div class="card" id="card-4">
                <div class="card-number">4</div> <!-- –î–û–ë–ê–í–õ–ï–ù–û: –ù–æ–º–µ—Ä –ø–ª–∞—à–∫–∏ -->
                <div class="card-text"></div>
                <img class="default-image" src="default.png" alt="–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ 4">
                <img class="status-icon" id="status-icon-4" alt="–°—Ç–∞—Ç—É—Å">
            </div>
            <img class="role-icon" id="role-icon-4" alt="–†–æ–ª—å">
            <!-- –î–û–ë–ê–í–õ–ï–ù–û: –ò–∫–æ–Ω–∫–∞ —á–µ—Ä–Ω–æ–π –∫–∞—Ä—Ç—ã -->
            <img class="black-card-icon" id="black-card-icon-4" src="Roles/–ú–∞—Ñ–∏—è.svg" alt="–ß–µ—Ä–Ω–∞—è –∫–∞—Ä—Ç–∞">
        </div>
        <div class="card-wrapper">
            <div class="card" id="card-5">
                <div class="card-number">5</div> <!-- –î–û–ë–ê–í–õ–ï–ù–û: –ù–æ–º–µ—Ä –ø–ª–∞—à–∫–∏ -->
                <div class="card-text"></div>
                <img class="default-image" src="default.png" alt="–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ 5">
                <img class="status-icon" id="status-icon-5" alt="–°—Ç–∞—Ç—É—Å">
            </div>
            <img class="role-icon" id="role-icon-5" alt="–†–æ–ª—å">
            <!-- –î–û–ë–ê–í–õ–ï–ù–û: –ò–∫–æ–Ω–∫–∞ —á–µ—Ä–Ω–æ–π –∫–∞—Ä—Ç—ã -->
            <img class="black-card-icon" id="black-card-icon-5" src="Roles/–ú–∞—Ñ–∏—è.svg" alt="–ß–µ—Ä–Ω–∞—è –∫–∞—Ä—Ç–∞">
        </div>
        <div class="card-wrapper">
            <div class="card" id="card-6">
                <div class="card-number">6</div> <!-- –î–û–ë–ê–í–õ–ï–ù–û: –ù–æ–º–µ—Ä –ø–ª–∞—à–∫–∏ -->
                <div class="card-text"></div>
                <img class="default-image" src="default.png" alt="–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ 6">
                <img class="status-icon" id="status-icon-6" alt="–°—Ç–∞—Ç—É—Å">
            </div>
            <img class="role-icon" id="role-icon-6" alt="–†–æ–ª—å">
            <!-- –î–û–ë–ê–í–õ–ï–ù–û: –ò–∫–æ–Ω–∫–∞ —á–µ—Ä–Ω–æ–π –∫–∞—Ä—Ç—ã -->
            <img class="black-card-icon" id="black-card-icon-6" src="Roles/–ú–∞—Ñ–∏—è.svg" alt="–ß–µ—Ä–Ω–∞—è –∫–∞—Ä—Ç–∞">
        </div>
        <div class="card-wrapper">
            <div class="card" id="card-7">
                <div class="card-number">7</div> <!-- –î–û–ë–ê–í–õ–ï–ù–û: –ù–æ–º–µ—Ä –ø–ª–∞—à–∫–∏ -->
                <div class="card-text"></div>
                <img class="default-image" src="default.png" alt="–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ 7">
                <img class="status-icon" id="status-icon-7" alt="–°—Ç–∞—Ç—É—Å">
            </div>
            <img class="role-icon" id="role-icon-7" alt="–†–æ–ª—å">
            <!-- –î–û–ë–ê–í–õ–ï–ù–û: –ò–∫–æ–Ω–∫–∞ —á–µ—Ä–Ω–æ–π –∫–∞—Ä—Ç—ã -->
            <img class="black-card-icon" id="black-card-icon-7" src="Roles/–ú–∞—Ñ–∏—è.svg" alt="–ß–µ—Ä–Ω–∞—è –∫–∞—Ä—Ç–∞">
        </div>
        <div class="card-wrapper">
            <div class="card" id="card-8">
                <div class="card-number">8</div> <!-- –î–û–ë–ê–í–õ–ï–ù–û: –ù–æ–º–µ—Ä –ø–ª–∞—à–∫–∏ -->
                <div class="card-text"></div>
                <img class="default-image" src="default.png" alt="–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ 8">
                <img class="status-icon" id="status-icon-8" alt="–°—Ç–∞—Ç—É—Å">
            </div>
            <img class="role-icon" id="role-icon-8" alt="–†–æ–ª—å">
            <!-- –î–û–ë–ê–í–õ–ï–ù–û: –ò–∫–æ–Ω–∫–∞ —á–µ—Ä–Ω–æ–π –∫–∞—Ä—Ç—ã -->
            <img class="black-card-icon" id="black-card-icon-8" src="Roles/–ú–∞—Ñ–∏—è.svg" alt="–ß–µ—Ä–Ω–∞—è –∫–∞—Ä—Ç–∞">
        </div>
        <div class="card-wrapper">
            <div class="card" id="card-9">
                <div class="card-number">9</div> <!-- –î–û–ë–ê–í–õ–ï–ù–û: –ù–æ–º–µ—Ä –ø–ª–∞—à–∫–∏ -->
                <div class="card-text"></div>
                <img class="default-image" src="default.png" alt="–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ 9">
                <img class="status-icon" id="status-icon-9" alt="–°—Ç–∞—Ç—É—Å">
            </div>
            <img class="role-icon" id="role-icon-9" alt="–†–æ–ª—å">
            <!-- –î–û–ë–ê–í–õ–ï–ù–û: –ò–∫–æ–Ω–∫–∞ —á–µ—Ä–Ω–æ–π –∫–∞—Ä—Ç—ã -->
            <img class="black-card-icon" id="black-card-icon-9" src="Roles/–ú–∞—Ñ–∏—è.svg" alt="–ß–µ—Ä–Ω–∞—è –∫–∞—Ä—Ç–∞">
        </div>
        <div class="card-wrapper">
            <div class="card" id="card-10">
                <div class="card-number">10</div> <!-- –î–û–ë–ê–í–õ–ï–ù–û: –ù–æ–º–µ—Ä –ø–ª–∞—à–∫–∏ -->
                <div class="card-text"></div>
                <img class="default-image" src="default.png" alt="–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ 10">
                <img class="status-icon" id="status-icon-10" alt="–°—Ç–∞—Ç—É—Å">
            </div>
            <img class="role-icon" id="role-icon-10" alt="–†–æ–ª—å">
            <!-- –î–û–ë–ê–í–õ–ï–ù–û: –ò–∫–æ–Ω–∫–∞ —á–µ—Ä–Ω–æ–π –∫–∞—Ä—Ç—ã -->
            <img class="black-card-icon" id="black-card-icon-10" src="Roles/–ú–∞—Ñ–∏—è.svg" alt="–ß–µ—Ä–Ω–∞—è –∫–∞—Ä—Ç–∞">
        </div>
    </div>
</div>
    <script src="scripts/scripts.js"></script>
    <script>
// WebSocket –¥–ª—è –æ–≤–µ—Ä–ª–µ—è
const proto = location.protocol === "https:" ? "wss:" : "ws:";
const WS_URL = proto + "//" + location.host;
const ws = new WebSocket(WS_URL);

ws.onopen = () => {
    console.log("‚úÖ Overlay –ø–æ–¥–∫–ª—é—á–µ–Ω –∫ —Å–µ—Ä–≤–µ—Ä—É");
};

ws.onmessage = (e) => {
    const data = JSON.parse(e.data);
    console.log("üì® Overlay –ø–æ–ª—É—á–∏–ª —Å–æ–æ–±—â–µ–Ω–∏–µ:", data);
    
    if (data.type === "initial_state") {
        // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤—Å–µ—Ö –ø–ª–∞—à–µ–∫
        for (let cardId in data.state) {
            updateCardFromServer(parseInt(cardId), data.state[cardId]);
        }
        return;
    }
    
    // –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –∫–æ–º–∞–Ω–¥—ã
    switch (data.type) {
        case "set_name":
            if (window.setPlayerName) setPlayerName(data.cardId, data.name);
            break;
        case "set_color":
            if (window.setCardColor) setCardColor(data.cardId, data.color);
            break;
        case "set_role":
            if (window.setCardRole) setCardRole(data.cardId, data.role);
            break;
        case "set_status":
            if (window.setCardStatus) setCardStatus(data.cardId, data.status);
            break;
        case "set_mafia_card":
            if (window.setMafiaCard) setMafiaCard(data.cardId, data.cardType, data.visible);
            break;
        case "reset_card":
            if (window.resetSingleCard) resetSingleCard(data.cardId);
            break;
        case "reset_all":
            for (let i = 1; i <= 10; i++) {
                if (window.resetSingleCard) resetSingleCard(i);
            }
            break;
    }
};

function updateCardFromServer(cardId, state) {
    if (state.name && window.setPlayerName) setPlayerName(cardId, state.name);
    if (state.color !== "default" && window.setCardColor) setCardColor(cardId, state.color);
    if (state.role && window.setCardRole) setCardRole(cardId, state.role);
    if (state.status && window.setCardStatus) setCardStatus(cardId, state.status);
    
    // –û–±–Ω–æ–≤–ª—è–µ–º –∫–∞—Ä—Ç–æ—á–∫–∏ –º–∞—Ñ–∏–∏
    if (window.setMafiaCard) {
        for (const cardType in state.mafiaCards) {
            setMafiaCard(cardId, cardType, state.mafiaCards[cardType]);
        }
    }
}

ws.onerror = (error) => {
    console.error("‚ùå WebSocket –æ—à–∏–±–∫–∞:", error);
};

ws.onclose = () => {
    console.log("üîå Overlay –æ—Ç–∫–ª—é—á–µ–Ω –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞");
};
    </script>

</body>
</html>